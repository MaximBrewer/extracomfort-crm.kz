import{u as C,r as h,W as L,j as e}from"./app-598a2ee8.js";import{A as D}from"./ArrowDown-e3e3fe98.js";import{I as u}from"./InputError-b1359c0e.js";import{I as y}from"./InputLabel-986a60cc.js";import{P as E}from"./PrimaryButton-283f7f95.js";import{T as I}from"./TextInput-ecf267e0.js";import{s as w}from"./statuses-52d2cf53.js";const P={data:[{code:"cash",title:"Наличными"},{code:"card",title:"Картой"},{code:"qr",title:"Kaspi QR"},{code:"balance",title:"C баланса"}]},q=x=>{const{book:o,auth:p}=x,f=`${p.user.role.name}.book.payment`,{setModal:i,priceFormat:m}=C(),[b,l]=h.useState(!1),{data:a,setData:d,post:N,patch:k,processing:S,errors:r,reset:B,transform:j}=L({method:null,sum:"",prepay:!1});j(t=>({...t,method:t.method?t.method.code:null}));const g=t=>{t&&t.preventDefault(),N(route(f,{book:o.id}),{onSuccess:()=>{i(null)}})},n=()=>l(!1);h.useEffect(()=>(document.addEventListener("clickinmodal",n),()=>{document.removeEventListener("clickinmodal",n)}),[]);const s=t=>{d(t.target.name,t.target.type==="checkbox"?t.target.checked:t.target.value)};return e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold text-xl text-center mb-4",children:"Оплата"}),e.jsxs("form",{onSubmit:g,className:"min-w-[18rem]",children:[e.jsxs("div",{className:"mb-4 select-none",children:[e.jsx(y,{htmlFor:"method",value:"Выберите метод оплаты",color:"text-gray-200",weight:"normal"}),e.jsxs("div",{className:"relative my-1",onClick:t=>t.stopPropagation(),children:[e.jsxs("a",{href:"#",onClick:t=>l(c=>!c),className:`flex itenms-center justify-between rounded-lg bg-gray-50 shadow-bb px-2.5 py-2 ${a.method?"text-violet-500":"text-gray-70"}`,children:[e.jsx("span",{children:a.method?a.method.title:"Не выбрано"}),e.jsx(D,{className:"w-4 h-auto text-gray-700"})]}),b?e.jsx("ul",{className:"absolute top-full left-0 w-full rounded-lg bg-gray-50 shadow-bb",children:P.data.map((t,c)=>e.jsx("li",{children:e.jsx("a",{href:"#",className:"block px-2.5 py-2 text-violet-500 border-t",onClick:v=>{v.preventDefault(),d(F=>({...F,method:t})),l(!1)},children:t.title})},c))}):""]}),e.jsx(u,{message:r.method,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(y,{htmlFor:"sum",value:"Сумма оплаты",color:"text-gray-200",weight:"normal"}),e.jsx(I,{id:"sum",type:"number",name:"sum",bg:"bg-gray-50",value:a.sum,className:"mt-1 block w-full text-xl",onChange:s}),e.jsx(u,{message:r.sum,className:"mt-2"})]}),e.jsxs("div",{className:"mb-4",children:["Баланс: ",e.jsx("span",{className:"text-blue-400",children:m(o.patient.balance)})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{htmlFor:"prepay",className:"flex items-center select-none cursor-pointer",children:[e.jsx("input",{type:"checkbox",name:"prepay",id:"prepay",onChange:s,defaultChecked:a.prepay,className:"hidden opacity-0 peer"}),e.jsx("div",{className:"mr-2 w-5 h-5 peer-checked:hidden border-violet-500 border rounded-[6px]"}),e.jsx("div",{className:"mr-2 w-5 h-5 hidden peer-checked:flex items-center justify-center border-violet-500 text-violet-500 border rounded-[6px]",children:e.jsx("svg",{className:"w-3 h-3",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M2.5 6L5 8.5L10 3.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("div",{children:"Предоплата"})]}),e.jsx(u,{message:r.prepay,className:"mt-2"})]}),e.jsx(E,{className:"w-full mb-4 justify-center text-lg font-semibold",children:"Отправить"}),e.jsx("div",{className:"text-center",children:e.jsx("a",{href:"#",className:"text-red-500 underline hover:no-underline",onClick:t=>{t.preventDefault(),i(null)},children:"Отменить"})})]})]})},K=x=>{const{book:o,auth:p}=x,f=`${p.user.role.name}.book.status`,i=w.data.find(s=>s.code==o.status),{setModal:m}=C(),[b,l]=h.useState(!1),{data:a,setData:d,post:N,patch:k,processing:S,errors:r,reset:B,transform:j}=L({status:i});j(s=>({...s,status:s.status.code}));const g=s=>{s&&s.preventDefault(),k(route(f,{book:o.id}),{onSuccess:()=>{m(null)}})},n=()=>l(!1);return h.useEffect(()=>(document.addEventListener("clickinmodal",n),()=>{document.removeEventListener("clickinmodal",n)}),[]),e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold text-xl text-center mb-4",children:"Статус"}),e.jsxs("form",{onSubmit:g,className:"min-w-[18rem]",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(y,{htmlFor:"status",value:"Выберите статус",color:"text-gray-200",weight:"font-normal"}),e.jsxs("div",{className:"relative my-1 select-none",onClick:s=>s.stopPropagation(),children:[e.jsxs("a",{href:"#",onClick:s=>l(t=>!t),className:`flex itenms-center justify-between rounded-lg bg-gray-50 shadow-bb px-2.5 py-2 ${a.status.color}`,children:[e.jsx("span",{children:a.status.title}),e.jsx(D,{className:"w-5 h-auto text-gray-700"})]}),b?e.jsx("ul",{className:"absolute top-full left-0 w-full rounded-lg bg-gray-50 shadow-bb",children:w.data.map((s,t)=>e.jsx("li",{children:e.jsx("a",{href:"#",className:`block px-2.5 py-2 ${s.color}`,onClick:c=>{c.preventDefault(),d(v=>({...v,status:s})),l(!1)},children:s.title})},t))}):""]}),e.jsx(u,{message:r.status,className:"mt-2"})]}),e.jsx(E,{className:"w-full my-4 justify-center text-lg font-semibold",children:"Изменить"}),e.jsx("div",{className:"text-center",children:e.jsx("a",{href:"#",className:"text-red-500 underline hover:no-underline",onClick:s=>{s.preventDefault(),m(null)},children:"Отменить"})})]})]})};export{K as B,q as a};
